

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aspire.apple package &mdash; ASPIRE 0.6.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="aspire.basis package" href="aspire.basis.html" />
    <link rel="prev" title="aspire.abinitio package" href="aspire.abinitio.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ASPIRE
          

          
          </a>

          
            
            
              <div class="version">
                0.6.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aspire.html">aspire package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="aspire.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="aspire.abinitio.html">aspire.abinitio package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">aspire.apple package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.basis.html">aspire.basis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.commands.html">aspire.commands package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.config.html">aspire.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.covariance.html">aspire.covariance package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.denoising.html">aspire.denoising package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.image.html">aspire.image package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.noise.html">aspire.noise package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.nufft.html">aspire.nufft package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.numeric.html">aspire.numeric package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.operators.html">aspire.operators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.optimization.html">aspire.optimization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.reconstruction.html">aspire.reconstruction package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.source.html">aspire.source package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.storage.html">aspire.storage package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.utils.html">aspire.utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.volume.html">aspire.volume package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire.exceptions">aspire.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASPIRE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
          <li><a href="aspire.html">aspire package</a> &raquo;</li>
        
      <li>aspire.apple package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/aspire.apple.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aspire-apple-package">
<h1>aspire.apple package<a class="headerlink" href="#aspire-apple-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-aspire.apple.apple">
<span id="aspire-apple-apple-module"></span><h2>aspire.apple.apple module<a class="headerlink" href="#module-aspire.apple.apple" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.apple.apple.Apple">
<em class="property">class </em><code class="descclassname">aspire.apple.apple.</code><code class="descname">Apple</code><span class="sig-paren">(</span><em>output_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.apple.Apple" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="aspire.apple.apple.Apple.particle_image">
<code class="descname">particle_image</code><span class="sig-paren">(</span><em>micro_img</em>, <em>particle_size</em>, <em>centers</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.apple.Apple.particle_image" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Return a numpy array representing the picked centers on a micrograph, suitable for rendering in a jupyter</dt>
<dd>notebook or saving as a jpg etc.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>micro_img</strong> – The micrograph image as a numpy array</li>
<li><strong>particle_size</strong> – Particle size of picked particles</li>
<li><strong>centers</strong> – Picked centers for micrograph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A numpy array with picked centers displayed as rectangles</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.apple.Apple.process_folder">
<code class="descname">process_folder</code><span class="sig-paren">(</span><em>folder</em>, <em>create_jpg=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.apple.Apple.process_folder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.apple.apple.Apple.process_micrograph">
<code class="descname">process_micrograph</code><span class="sig-paren">(</span><em>filepath</em>, <em>return_centers=True</em>, <em>return_img=False</em>, <em>show_progress=True</em>, <em>create_jpg=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.apple.Apple.process_micrograph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.apple.apple.Apple.verify_input_values">
<code class="descname">verify_input_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.apple.Apple.verify_input_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aspire.apple.helper">
<span id="aspire-apple-helper-module"></span><h2>aspire.apple.helper module<a class="headerlink" href="#module-aspire.apple.helper" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.apple.helper.PickerHelper">
<em class="property">class </em><code class="descclassname">aspire.apple.helper.</code><code class="descname">PickerHelper</code><a class="headerlink" href="#aspire.apple.helper.PickerHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.extract_query">
<em class="property">classmethod </em><code class="descname">extract_query</code><span class="sig-paren">(</span><em>img</em>, <em>block_size</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.extract_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract all query images from the micrograph. windows are
extracted with steps of size (block_size/2)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>img: Micrograph image.
block_size: Query images must be of size (block_size x block_size).</dd>
<dt>Returns:</dt>
<dd>4D Matrix of query images.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.extract_references">
<em class="property">classmethod </em><code class="descname">extract_references</code><span class="sig-paren">(</span><em>img</em>, <em>query_size</em>, <em>container_size</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.extract_references" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses and extracts reference images from the micrograph.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>img: Micrograph image.
query_size: Reference images must be of the same size of query images, i.e. (query_size x query_size).
container_size: Containers are large regions used to select reference images. The size of each
region is (container_size x container_size)</dd>
<dt>Returns:</dt>
<dd>3D Matrix of reference images.  windows[0] is the first reference window.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.extract_windows">
<em class="property">classmethod </em><code class="descname">extract_windows</code><span class="sig-paren">(</span><em>img</em>, <em>block_size</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.extract_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts blocks of size (block_size x block_size) from the micrograph. Blocks are
extracted with steps of size (block_size)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>img: Micrograph image.
block_size: required block size.</dd>
<dt>Returns:</dt>
<dd>3D Matrix of blocks. For example, img[0] is the first block.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.gaussian_filter">
<em class="property">classmethod </em><code class="descname">gaussian_filter</code><span class="sig-paren">(</span><em>size_filter</em>, <em>std</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes low-pass filter.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>size_filter: Size of filter (size_filter x size_filter).
std: sigma value in filter.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.get_training_set">
<em class="property">classmethod </em><code class="descname">get_training_set</code><span class="sig-paren">(</span><em>micro_img</em>, <em>bw_mask_p</em>, <em>bw_mask_n</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.get_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets training set for the SVM classifier.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>micro_img: Micrograph image.
bw_mask_p: Binary image indicating regions from which to extract examples of particles.
bw_mask_n: Binary image indicating regions from which to extract examples of noise.
n: Size of training windows.</dd>
<dt>Returns:</dt>
<dd>A matrix of features and a vector of labels for the SVM training.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.moments">
<em class="property">classmethod </em><code class="descname">moments</code><span class="sig-paren">(</span><em>img</em>, <em>query_size</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean and standard deviation for each window of size (query_size x query_size)
in the micrograph.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>img: Micrograph image.
query_size: Size of windows for which to compute mean and std.</dd>
<dt>Returns:</dt>
<dd>A matrix of mean intensity and a matrix of variance, each containing a single
entry for each possible (query_size x query_size) window in the micrograph.</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="aspire.apple.helper.PickerHelper.reference_size">
<em class="property">classmethod </em><code class="descname">reference_size</code><span class="sig-paren">(</span><em>img</em>, <em>container_size</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.helper.PickerHelper.reference_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aspire.apple.picking">
<span id="aspire-apple-picking-module"></span><h2>aspire.apple.picking module<a class="headerlink" href="#module-aspire.apple.picking" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.apple.picking.Picker">
<em class="property">class </em><code class="descclassname">aspire.apple.picking.</code><code class="descname">Picker</code><span class="sig-paren">(</span><em>particle_size</em>, <em>max_size</em>, <em>min_size</em>, <em>query_size</em>, <em>tau1</em>, <em>tau2</em>, <em>moa</em>, <em>container_size</em>, <em>filename</em>, <em>output_directory</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class does the actual picking with help from PickerHelper class.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="aspire.apple.picking.Picker.extract_particles">
<code class="descname">extract_particles</code><span class="sig-paren">(</span><em>segmentation</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.extract_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves particle centers into output .star file, after dismissing regions
that are too big to contain a particle.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>segmentation: Segmentation of the micrograph into noise and particle projections.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.picking.Picker.get_maps">
<code class="descname">get_maps</code><span class="sig-paren">(</span><em>score</em>, <em>micro_img</em>, <em>particle_windows</em>, <em>non_noise_windows</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.get_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets maps of regions from which to extract particle training for the SVM classifier.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>score: Matrix containing a score for each query image.
micro_img: Micrograph image.
particle_windows: Number of windows that must contain a particle.
non_noise_windows: Number of windows that contain neither noise nor particles.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.picking.Picker.morphology_ops">
<code class="descname">morphology_ops</code><span class="sig-paren">(</span><em>segmentation</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.morphology_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>Discards suspected artifacts from segmentation.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>segmentation: Segmentation of the micrograph into noise and particle projections.</dd>
<dt>Returns:</dt>
<dd>Segmentation of the micrograph into noise and particle projections.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.picking.Picker.query_score">
<code class="descname">query_score</code><span class="sig-paren">(</span><em>show_progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.query_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates score for each query image.</p>
<p>Extracts query images and reference windows. Computes the cross-correlation between these
windows, and applies a threshold to compute a score for each query image.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>show_progress: Whether to show a progress bar</dd>
<dt>Returns:</dt>
<dd>Matrix containing a score for each query image.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.picking.Picker.read_mrc">
<code class="descname">read_mrc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.read_mrc" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets and preprocesses micrograph.</p>
<p>Reads the micrograph, applies binning and a low-pass filter.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>Micrograph image.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="aspire.apple.picking.Picker.run_svm">
<code class="descname">run_svm</code><span class="sig-paren">(</span><em>score</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.apple.picking.Picker.run_svm" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains and uses an SVM classifier.</p>
<p>Trains an SVM classifier to distinguish between noise and particle projections based on
mean intensity and variance. Every possible window in the micrograph is then classified
as either noise or particle, resulting in a segmentation of the micrograph.</p>
<p>Args:</p>
<blockquote>
<div>score: Matrix containing a score for each query image.</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>Segmentation of the micrograph into noise and particle projections.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aspire.apple">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aspire.apple" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aspire.basis.html" class="btn btn-neutral float-right" title="aspire.basis package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aspire.abinitio.html" class="btn btn-neutral float-left" title="aspire.abinitio package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Princeton University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>