

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aspire.aspire package &mdash; ASPIRE 0.5.28 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="aspire.aspire.common package" href="aspire.aspire.common.html" />
    <link rel="prev" title="aspire.apple package" href="aspire.apple.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ASPIRE
          

          
          </a>

          
            
            
              <div class="version">
                0.5.28
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aspire.html">aspire package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="aspire.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="aspire.apple.html">aspire.apple package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">aspire.aspire package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.basis.html">aspire.basis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.class2d.html">aspire.class2d package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.class3d.html">aspire.class3d package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.commands.html">aspire.commands package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.data.html">aspire.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.denoising.html">aspire.denoising package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.estimation.html">aspire.estimation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.image.html">aspire.image package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.io.html">aspire.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.nfft.html">aspire.nfft package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.orientation.html">aspire.orientation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.picker.html">aspire.picker package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.reconstruct.html">aspire.reconstruct package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.source.html">aspire.source package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.utils.html">aspire.utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.volume.html">aspire.volume package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire.exceptions">aspire.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire.version">aspire.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASPIRE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
          <li><a href="aspire.html">aspire package</a> &raquo;</li>
        
      <li>aspire.aspire package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/aspire.aspire.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aspire-aspire-package">
<h1>aspire.aspire package<a class="headerlink" href="#aspire-aspire-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="aspire.aspire.common.html">aspire.aspire.common package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.common.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.common.html#module-aspire.aspire.common.config">aspire.aspire.common.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.common.html#module-aspire.aspire.common.logger">aspire.aspire.common.logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.common.html#module-aspire.aspire.common">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aspire.aspire.em_classavg.html">aspire.aspire.em_classavg package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="aspire.aspire.em_classavg.image_denoising.html">aspire.aspire.em_classavg.image_denoising package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="aspire.aspire.em_classavg.image_denoising.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.aspire.em_classavg.image_denoising.html#module-aspire.aspire.em_classavg.image_denoising">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-circ-shift-kernel-module">aspire.aspire.em_classavg.circ_shift_kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#module-aspire.aspire.em_classavg.config">aspire.aspire.em_classavg.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#module-aspire.aspire.em_classavg.data_utils">aspire.aspire.em_classavg.data_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-em-module">aspire.aspire.em_classavg.em module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-em-old-module">aspire.aspire.em_classavg.em_old module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-mask-images-kernel-module">aspire.aspire.em_classavg.mask_images_kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-s-em-module">aspire.aspire.em_classavg.s_em module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-s-em-class-avg-module">aspire.aspire.em_classavg.s_em_class_avg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-slice-assign-kernel-module">aspire.aspire.em_classavg.slice_assign_kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-test-forward-backward-module">aspire.aspire.em_classavg.test_forward_backward module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#aspire-aspire-em-classavg-test-progressbar2-module">aspire.aspire.em_classavg.test_progressbar2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.em_classavg.html#module-aspire.aspire.em_classavg">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aspire.aspire.utils.html">aspire.aspire.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.array_utils">aspire.aspire.utils.array_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.compare_stacks">aspire.aspire.utils.compare_stacks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.data_utils">aspire.aspire.utils.data_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.helpers">aspire.aspire.utils.helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.parse_star">aspire.aspire.utils.parse_star module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils.viewstack">aspire.aspire.utils.viewstack module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#aspire-aspire-utils-workflow-validation-module">aspire.aspire.utils.workflow_validation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspire.aspire.utils.html#module-aspire.aspire.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-aspire.aspire.abinitio">
<span id="aspire-aspire-abinitio-module"></span><h2>aspire.aspire.abinitio module<a class="headerlink" href="#module-aspire.aspire.abinitio" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="aspire.aspire.abinitio.Abinitio">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">Abinitio</code><a class="headerlink" href="#aspire.aspire.abinitio.Abinitio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abinitio class contains all functions related to Abinitio algorithm.</p>
<p class="rubric">Methods</p>
<dl class="py method">
<dt id="aspire.aspire.abinitio.Abinitio.cryo_abinitio_c1_worker">
<em class="property">classmethod </em><code class="sig-name descname">cryo_abinitio_c1_worker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.Abinitio.cryo_abinitio_c1_worker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.abinitio.DiracBasis">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">DiracBasis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sz</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.DiracBasis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="py method">
<dt id="aspire.aspire.abinitio.DiracBasis.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.DiracBasis.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.abinitio.DiracBasis.evaluate_t">
<code class="sig-name descname">evaluate_t</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.DiracBasis.evaluate_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.abinitio.DiracBasis.expand">
<code class="sig-name descname">expand</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.DiracBasis.expand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.abinitio.DiracBasis.expand_t">
<code class="sig-name descname">expand_t</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.DiracBasis.expand_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.anufft3">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">anufft3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vol_f</span></em>, <em class="sig-param"><span class="n">fourier_pts</span></em>, <em class="sig-param"><span class="n">sz</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.anufft3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.apply_mean_kernel">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">apply_mean_kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vol_basis</span></em>, <em class="sig-param"><span class="n">kernel_f</span></em>, <em class="sig-param"><span class="n">basis</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.apply_mean_kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cart2pol">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cart2pol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cart2pol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cfft2">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cfft2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cfft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.check_imaging_params">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">check_imaging_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.check_imaging_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.circularize_kernel_1d">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">circularize_kernel_1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">dim</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.circularize_kernel_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.circularize_kernel_f">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">circularize_kernel_f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel_f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.circularize_kernel_f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.common_line_r">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">common_line_r</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r1</span></em>, <em class="sig-param"><span class="n">r2</span></em>, <em class="sig-param"><span class="n">l</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.common_line_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.comp">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">comp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.comp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.conj_grad">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">conj_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a_fun</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">cg_opt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.conj_grad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_clmatrix_cpu">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_clmatrix_cpu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pf</span></em>, <em class="sig-param"><span class="n">nk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_shift</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">shift_step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">map_filter_radius</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ref_clmatrix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ref_shifts_2d</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_clmatrix_cpu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_clmatrix_cpu_ref">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_clmatrix_cpu_ref</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pf</span></em>, <em class="sig-param"><span class="n">nk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_shift</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">shift_step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">map_filter_radius</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ref_clmatrix</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ref_shifts_2d</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_clmatrix_cpu_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_conj_grad_mean">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_conj_grad_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel_f</span></em>, <em class="sig-param"><span class="n">im_bp</span></em>, <em class="sig-param"><span class="n">basis</span></em>, <em class="sig-param"><span class="n">precond_kernel_f</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mean_est_opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_conj_grad_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_conv_vol">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_conv_vol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">kernel_f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_conv_vol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_estimate_mean">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_estimate_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">basis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mean_est_opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_estimate_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>1e-5 error from matlab
:param im:
:param params:
:param basis:
:param mean_est_opt:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_estimate_shifts">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_estimate_shifts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pf</span></em>, <em class="sig-param"><span class="n">rotations</span></em>, <em class="sig-param"><span class="n">max_shift</span></em>, <em class="sig-param"><span class="n">shift_step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">memory_factor</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">shifts_2d_ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_estimate_shifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_mean_backproject">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_mean_backproject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">mean_est_opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_mean_backproject" title="Permalink to this definition">¶</a></dt>
<dd><p>1e-7 error from matlab
:param im:
:param params:
:param mean_est_opt:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_mean_kernel_f">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_mean_kernel_f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resolution</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">mean_est_opt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_mean_kernel_f" title="Permalink to this definition">¶</a></dt>
<dd><p>8e-14 error from matlab
:param resolution:
:param params:
:param mean_est_opt:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_pft">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_pft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n_r</span></em>, <em class="sig-param"><span class="n">n_theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_pft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the polar Fourier transform of projections with resolution n_r in the radial direction
and resolution n_theta in the angular direction.
:param p:
:param n_r: Number of samples along each ray (in the radial direction).
:param n_theta: Angular resolution. Number of Fourier rays computed for each projection.
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_ray_normalize">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_ray_normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_ray_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_sync_rotations">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_sync_rotations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">rots_ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_sync_rotations" title="Permalink to this definition">¶</a></dt>
<dd><p>3e-14 err from matlab
:param s:
:param rots_ref:
:param verbose:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_syncmatrix_ij_vote">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_syncmatrix_ij_vote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clmatrix</span></em>, <em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">l</span></em>, <em class="sig-param"><span class="n">rots_ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_perturbed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_syncmatrix_ij_vote" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_syncmatrix_vote">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_syncmatrix_vote</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clmatrix</span></em>, <em class="sig-param"><span class="n">l</span></em>, <em class="sig-param"><span class="n">rots_ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_perturbed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_syncmatrix_vote" title="Permalink to this definition">¶</a></dt>
<dd><p>3e-16 error from matlab
:param clmatrix:
:param l:
:param rots_ref:
:param is_perturbed:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.cryo_vote_ij">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">cryo_vote_ij</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clmatrix</span></em>, <em class="sig-param"><span class="n">l</span></em>, <em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">rots_ref</span></em>, <em class="sig-param"><span class="n">is_perturbed</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.cryo_vote_ij" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.fill_struct">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">fill_struct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">att_vals</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.fill_struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill object with attributes in a dictionary.
If a struct is not given a new object will be created and filled.
If the given struct has a field in att_vals, the original field will stay, unless specified otherwise in overwrite.
att_vals is a dictionary with string keys, and for each key:
if hasattr(s, key) and key in overwrite:</p>
<blockquote>
<div><p>pass</p>
</div></blockquote>
<dl class="simple">
<dt>else:</dt><dd><p>setattr(s, key, att_vals[key])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – </p></li>
<li><p><strong>att_vals</strong> – </p></li>
</ul>
</dd>
</dl>
<p>:param overwrite
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.fix_signs">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">fix_signs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.fix_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>makes the matrix coloumn sign be by the biggest value
:param u: matrix
:return: matrix</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.fuzzy_mask">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">fuzzy_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">r0</span></em>, <em class="sig-param"><span class="n">origin</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.fuzzy_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.icfft2">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">icfft2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.icfft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.im_backproject">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">im_backproject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">rot_matrices</span></em>, <em class="sig-param"><span class="n">half_pixel</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.im_backproject" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.im_filter">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">im_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">filter_f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.im_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.mdim_fftshift">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">mdim_fftshift</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dims</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.mdim_fftshift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.mdim_ifftshift">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">mdim_ifftshift</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dims</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.mdim_ifftshift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.mesh_2d">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">mesh_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resolution</span></em>, <em class="sig-param"><span class="n">inclusive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.mesh_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.rotated_grids">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">rotated_grids</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resolution</span></em>, <em class="sig-param"><span class="n">rot_matrices</span></em>, <em class="sig-param"><span class="n">half_pixel</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.rotated_grids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.rotratio_eulerangle_vec">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">rotratio_eulerangle_vec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cl</span></em>, <em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">good_k</span></em>, <em class="sig-param"><span class="n">n_theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.rotratio_eulerangle_vec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.abinitio.subset_params">
<code class="sig-prename descclassname">aspire.aspire.abinitio.</code><code class="sig-name descname">subset_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">ind</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.abinitio.subset_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-aspire.aspire.class_averaging">
<span id="aspire-aspire-class-averaging-module"></span><h2>aspire.aspire.class_averaging module<a class="headerlink" href="#module-aspire.aspire.class_averaging" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="aspire.aspire.class_averaging.Basis">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">Basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi_ns</span></em>, <em class="sig-param"><span class="n">angular_freqs</span></em>, <em class="sig-param"><span class="n">radian_freqs</span></em>, <em class="sig-param"><span class="n">n_theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.Basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.class_averaging.ClassAverages">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">ClassAverages</code><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.align_main">
<em class="property">classmethod </em><code class="sig-name descname">align_main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">angle</span></em>, <em class="sig-param"><span class="n">class_vdm</span></em>, <em class="sig-param"><span class="n">refl</span></em>, <em class="sig-param"><span class="n">spca_data</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">max_shifts</span></em>, <em class="sig-param"><span class="n">list_recon</span></em>, <em class="sig-param"><span class="n">tmpdir</span></em>, <em class="sig-param"><span class="n">use_em</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.align_main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.choose_support_v6">
<em class="property">classmethod </em><code class="sig-name descname">choose_support_v6</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">proj_ctf_noisy</span></em>, <em class="sig-param"><span class="n">energy_threshold</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.choose_support_v6" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine sizes of the compact support in both real and Fourier space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proj_ctf_noisy</strong> – </p></li>
<li><p><strong>energy_threshold</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(c_limit, R_limit):
c_limit: Size of support in Fourier space
R_limit: Size of support in real space</p>
</dd>
</dl>
<p>We scale the images in real space by L, so that the noise variance in
both real and Fourier domains is the same.</p>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.compute_spca">
<em class="property">classmethod </em><code class="sig-name descname">compute_spca</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">images</span></em>, <em class="sig-param"><span class="n">noise_v_r</span></em>, <em class="sig-param"><span class="n">adaptive_support</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.compute_spca" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.initial_classification_fd_update">
<em class="property">classmethod </em><code class="sig-name descname">initial_classification_fd_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spca_data</span></em>, <em class="sig-param"><span class="n">n_nbor</span></em>, <em class="sig-param"><span class="n">is_rand</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.initial_classification_fd_update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.jobscript_ffbspca">
<em class="property">classmethod </em><code class="sig-name descname">jobscript_ffbspca</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">images</span></em>, <em class="sig-param"><span class="n">support_size</span></em>, <em class="sig-param"><span class="n">noise_var</span></em>, <em class="sig-param"><span class="n">basis</span></em>, <em class="sig-param"><span class="n">sample_points</span></em>, <em class="sig-param"><span class="n">num_threads</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.jobscript_ffbspca" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.precompute_fb">
<em class="property">classmethod </em><code class="sig-name descname">precompute_fb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_r</span></em>, <em class="sig-param"><span class="n">support_size</span></em>, <em class="sig-param"><span class="n">bandlimit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.precompute_fb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.run">
<em class="property">classmethod </em><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_images</span></em>, <em class="sig-param"><span class="n">output_images</span></em>, <em class="sig-param"><span class="n">n_nbor</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nn_avg</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.ClassAverages.vdm">
<em class="property">classmethod </em><code class="sig-name descname">vdm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">classes</span></em>, <em class="sig-param"><span class="n">corr</span></em>, <em class="sig-param"><span class="n">rot</span></em>, <em class="sig-param"><span class="n">class_refl</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">flag</span></em>, <em class="sig-param"><span class="n">n_nbor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ClassAverages.vdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.class_averaging.FastRotatePrecomp">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">FastRotatePrecomp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">mx</span></em>, <em class="sig-param"><span class="n">my</span></em>, <em class="sig-param"><span class="n">mult90</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.FastRotatePrecomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.class_averaging.Precomp">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">Precomp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_theta</span></em>, <em class="sig-param"><span class="n">n_r</span></em>, <em class="sig-param"><span class="n">resolution</span></em>, <em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.Precomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.class_averaging.SamplePoints">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">SamplePoints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">w</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.SamplePoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="aspire.aspire.class_averaging.SpcaData">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">SpcaData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eigval</span></em>, <em class="sig-param"><span class="n">freqs</span></em>, <em class="sig-param"><span class="n">radial_freqs</span></em>, <em class="sig-param"><span class="n">coeff</span></em>, <em class="sig-param"><span class="n">mean</span></em>, <em class="sig-param"><span class="n">bandlimit</span></em>, <em class="sig-param"><span class="n">supp_num</span></em>, <em class="sig-param"><span class="n">eig_im</span></em>, <em class="sig-param"><span class="n">fn0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.SpcaData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="py method">
<dt id="aspire.aspire.class_averaging.SpcaData.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj_dir</span></em>, <em class="sig-param"><span class="n">matlab</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.SpcaData.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.class_averaging.SpcaData.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.SpcaData.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.adjust_rotate">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">adjust_rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.adjust_rotate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.bessel_ns_radial">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">bessel_ns_radial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bandlimit</span></em>, <em class="sig-param"><span class="n">support_size</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.bessel_ns_radial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.bispec_2drot_large">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">bispec_2drot_large</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span></em>, <em class="sig-param"><span class="n">freqs</span></em>, <em class="sig-param"><span class="n">eigval</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.bispec_2drot_large" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.bispec_operator_1">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">bispec_operator_1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.bispec_operator_1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.cart2rad">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">cart2rad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.cart2rad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.comp">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">comp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.comp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.comp_array_of_npy">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">comp_array_of_npy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.comp_array_of_npy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.comp_sparse">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">comp_sparse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.comp_sparse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.compare_relative_to_classes">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">compare_relative_to_classes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a1</span></em>, <em class="sig-param"><span class="n">b1</span></em>, <em class="sig-param"><span class="n">a2</span></em>, <em class="sig-param"><span class="n">b2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.compare_relative_to_classes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.cryo_image_contrast">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">cryo_image_contrast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">projs</span></em>, <em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.cryo_image_contrast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.cryo_pft_nfft">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">cryo_pft_nfft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">projections</span></em>, <em class="sig-param"><span class="n">precomp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.cryo_pft_nfft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.cryo_select_subset">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">cryo_select_subset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">classes</span></em>, <em class="sig-param"><span class="n">size_output</span></em>, <em class="sig-param"><span class="n">priority</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">to_image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_skip</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.cryo_select_subset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.cryo_smart_select_subset">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">cryo_smart_select_subset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">classes</span></em>, <em class="sig-param"><span class="n">size_output</span></em>, <em class="sig-param"><span class="n">priority</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">to_image</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.cryo_smart_select_subset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.fast_rotate_image">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">fast_rotate_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">tmps</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plans</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.fast_rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Could make it faster without the flag ‘FFTW_UNALIGNED’ if I could make
:param image:
:param phi:
:param tmps:
:param plans:
:param m:
:return:</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.fast_rotate_precomp">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">fast_rotate_precomp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">szx</span></em>, <em class="sig-param"><span class="n">szy</span></em>, <em class="sig-param"><span class="n">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.fast_rotate_precomp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.fbcoeff_nfft">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">fbcoeff_nfft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">split_images</span></em>, <em class="sig-param"><span class="n">support_size</span></em>, <em class="sig-param"><span class="n">basis</span></em>, <em class="sig-param"><span class="n">sample_points</span></em>, <em class="sig-param"><span class="n">num_threads</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.fbcoeff_nfft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.fix_signs">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">fix_signs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.fix_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>makes the matrix coloumn sign be by the biggest value
:param u: matrix
:return: matrix</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.fix_svd">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">fix_svd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.fix_svd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.get_fast_rotate_vars">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">get_fast_rotate_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">resolution</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.get_fast_rotate_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.icfft">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">icfft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.icfft" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.ift_fb">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">ift_fb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">support_size</span></em>, <em class="sig-param"><span class="n">bandlimit</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.ift_fb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.initial_class_comp">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">initial_class_comp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a1</span></em>, <em class="sig-param"><span class="n">a2</span></em>, <em class="sig-param"><span class="n">b1</span></em>, <em class="sig-param"><span class="n">b2</span></em>, <em class="sig-param"><span class="n">c1</span></em>, <em class="sig-param"><span class="n">c2</span></em>, <em class="sig-param"><span class="n">d1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">d2</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.initial_class_comp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.lgwt">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">lgwt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.lgwt" title="Permalink to this definition">¶</a></dt>
<dd><p>Get leggauss points in interval [a, b]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – number of points</p></li>
<li><p><strong>a</strong> – interval starting point</p></li>
<li><p><strong>b</strong> – interval end point</p></li>
</ul>
</dd>
<dt class="field-even">Returns SamplePoints(x, w)</dt>
<dd class="field-even"><p>sample points, weight</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.max_dif">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">max_dif</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.max_dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.max_dif_matrices_sign_invariant">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">max_dif_matrices_sign_invariant</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.max_dif_matrices_sign_invariant" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.nudft2">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">nudft2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.nudft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.nufft2">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">nufft2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.nufft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.pca_y">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">pca_y</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">k</span></em>, <em class="sig-param"><span class="n">num_iters</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.pca_y" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.pft_freqs">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">pft_freqs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">n_theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.pft_freqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.rot_align">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">rot_align</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">coeff</span></em>, <em class="sig-param"><span class="n">pairs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.rot_align" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.script_find_graph_weights_v3">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">script_find_graph_weights_v3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.script_find_graph_weights_v3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.sort_list_weights_wrefl">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">sort_list_weights_wrefl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">classes</span></em>, <em class="sig-param"><span class="n">corr</span></em>, <em class="sig-param"><span class="n">rot</span></em>, <em class="sig-param"><span class="n">refl</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.sort_list_weights_wrefl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.spca_data_compare">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">spca_data_compare</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.spca_data_compare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.spca_whole">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">spca_whole</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span></em>, <em class="sig-param"><span class="n">var_hat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.spca_whole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.test">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.test2">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">test2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">im</span></em>, <em class="sig-param"><span class="n">freqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.test2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.union_row_idx">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">union_row_idx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.union_row_idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.vdm_angle_v2">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">vdm_angle_v2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.vdm_angle_v2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="aspire.aspire.class_averaging.vdm_lp">
<code class="sig-prename descclassname">aspire.aspire.class_averaging.</code><code class="sig-name descname">vdm_lp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h1</span></em>, <em class="sig-param"><span class="n">num_eig</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.class_averaging.vdm_lp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h1</strong> – </p></li>
<li><p><strong>num_eig</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>(This version of VDM still doesn’t work on MATLAB)</p>
</dd></dl>

</div>
<div class="section" id="module-aspire.aspire.preprocessor">
<span id="aspire-aspire-preprocessor-module"></span><h2>aspire.aspire.preprocessor module<a class="headerlink" href="#module-aspire.aspire.preprocessor" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="aspire.aspire.preprocessor.PreProcessor">
<em class="property">class </em><code class="sig-prename descclassname">aspire.aspire.preprocessor.</code><code class="sig-name descname">PreProcessor</code><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.crop">
<em class="property">static </em><code class="sig-name descname">crop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mat</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">stack</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the size of a vector, square or cube ‘mat’ by cropping (or
increase the size by padding with fill_value, by default zero) to a final
size of n, (n x n), or (n x n x n) respectively. This is the analogue of downsample, but
it doesn’t change magnification.</p>
<p>If mat is 2-dimensional and n is a vector, m is cropped to n=[mat_x mat_y].</p>
<p>The function handles odd and even-sized arrays correctly. The center of
an odd array is taken to be at (n+1)/2, and an even array is n/2+1.</p>
<p>If flag is_stack is set to True, then a 3D array ‘mat’ is treated as a stack of 2D
images, and each image is cropped to (n x n).</p>
<p>For 2D images, the input image doesn’t have to be square.</p>
<ul class="simple">
<li><p>The original MATLAB function supported cropping to non-square matrices.
As real-world uses will always crop to square (n, n), we don’t support it with Python.</p></li>
</ul>
<dl class="simple">
<dt>Args:</dt><dd><p>mat (numpy.array): Vector, 2D array, stack of 2D arrays or a 3D array
n (int): Size of desired cropped vector, side of 2D array or side of 3D array
stack (bool): Set to True in order to handle a 3D mat as a stack of 2D
fill_value (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional): Padding value. Defaults to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>numpy.array: Cropped or padded mat to size of n, (n x n) or (n x n x n)</p>
</dd>
</dl>
<p>TODO: change name to ‘resize’? crop/pad is confusing b/c either you save different
TODO:   output names or you stick to a misleading name like cropped.mrc for padded stack</p>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.crop_stack">
<em class="property">classmethod </em><code class="sig-name descname">crop_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.crop_stack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.crop_stack_file">
<em class="property">classmethod </em><code class="sig-name descname">crop_stack_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_file</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">output_stack_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.crop_stack_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.cryo_noise_estimation">
<em class="property">static </em><code class="sig-name descname">cryo_noise_estimation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">projections</span></em>, <em class="sig-param"><span class="n">radius_of_mask</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.cryo_noise_estimation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.cryo_prewhiten">
<em class="property">classmethod </em><code class="sig-name descname">cryo_prewhiten</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">proj</span></em>, <em class="sig-param"><span class="n">noise_response</span></em>, <em class="sig-param"><span class="n">rel_threshold</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.cryo_prewhiten" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-whiten a stack of projections using the power spectrum of the noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proj</strong> – stack of images/projections</p></li>
<li><p><strong>noise_response</strong> – 2d image with the power spectrum of the noise. If all
images are to be whitened with respect to the same power spectrum,
this is a single image. If each image is to be whitened with respect
to a different power spectrum, this is a three-dimensional array with
the same number of 2d slices as the stack of images.</p></li>
<li><p><strong>rel_threshold</strong> – The relative threshold used to determine which frequencies
to whiten and which to set to zero. If empty (the default)
all filter values less than 100*eps(class(proj)) are
zeroed out, while otherwise, all filter values less than
threshold times the maximum filter value for each filter
is set to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pre-whitened stack of images.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.downsample">
<em class="property">classmethod </em><code class="sig-name descname">downsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span></em>, <em class="sig-param"><span class="n">side</span></em>, <em class="sig-param"><span class="n">compute_fx</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stack</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Fourier methods to change the sample interval and/or aspect ratio
of any dimensions of the input image ‘img’. If the optional argument
stack is set to True, then the <em>first</em> dimension of ‘img’ is interpreted as the index of
each image in the stack. The size argument side is an integer, the size of the
output images.  Let the size of a stack
of 2D images ‘img’ be n1 x n1 x k.  The size of the output will be side x side x k.</p>
<p>If the optional mask argument is given, this is used as the
zero-centered Fourier mask for the re-sampling. The size of mask should
be the same as the output image size. For example for downsampling an
n0 x n0 image with a 0.9 x nyquist filter, do the following:
msk = fuzzymask(n,2,.45*n,.05*n)
out = downsample(img, n, 0, msk)
The size of the mask must be the size of output. The optional fx output
argument is the padded or cropped, masked, FT of in, with zero
frequency at the origin.</p>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.downsample_stack_file">
<em class="property">classmethod </em><code class="sig-name descname">downsample_stack_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_file</span></em>, <em class="sig-param"><span class="n">side</span></em>, <em class="sig-param"><span class="n">output_stack_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.downsample_stack_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.global_phaseflip_stack">
<em class="property">static </em><code class="sig-name descname">global_phaseflip_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.global_phaseflip_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply global phase flip to an image stack if needed.</p>
<p>Check if all images in a stack should be globally phase flipped so that
the molecule corresponds to brighter pixels and the background corresponds
to darker pixels. This is done by comparing the mean in a small circle
around the origin (supposed to correspond to the molecule) with the mean
of the noise, and making sure that the mean of the molecule is larger.</p>
<dl class="simple">
<dt>Examples:</dt><dd><p>&gt;&gt; import mrcfile
&gt;&gt; stack = mrcfile.open(‘stack.mrcs’)
&gt;&gt; stack = global_phaseflip_stack(stack)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stack</strong> – stack of images to phaseflip if needed</p>
</dd>
<dt class="field-even">Return stack</dt>
<dd class="field-even"><p>stack which might be phaseflipped when needed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.global_phaseflip_stack_file">
<em class="property">classmethod </em><code class="sig-name descname">global_phaseflip_stack_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_file</span></em>, <em class="sig-param"><span class="n">output_stack_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.global_phaseflip_stack_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.normalize_background">
<em class="property">classmethod </em><code class="sig-name descname">normalize_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack</span></em>, <em class="sig-param"><span class="n">radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.normalize_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize background to mean 0 and std 1.
Estimate the mean and std of each image in the stack using pixels
outside radius r (pixels), and normalize the image such that the
background has mean 0 and std 1. Each image in the stack is corrected
separately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radius</strong> – radius for normalization (default is half the side of image)</p>
</dd>
</dl>
<p>Example:
normalized_stack = cryo_normalize_background(stack,55);</p>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.phaseflip_star_file">
<em class="property">classmethod </em><code class="sig-name descname">phaseflip_star_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star_file</span></em>, <em class="sig-param"><span class="n">pixel_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.phaseflip_star_file" title="Permalink to this definition">¶</a></dt>
<dd><p>todo add verbosity</p>
</dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.prewhiten_stack">
<em class="property">classmethod </em><code class="sig-name descname">prewhiten_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.prewhiten_stack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="aspire.aspire.preprocessor.PreProcessor.prewhiten_stack_file">
<em class="property">classmethod </em><code class="sig-name descname">prewhiten_stack_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_file</span></em>, <em class="sig-param"><span class="n">output</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.PreProcessor.prewhiten_stack_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.preprocessor.cryo_CTF_Relion">
<code class="sig-prename descclassname">aspire.aspire.preprocessor.</code><code class="sig-name descname">cryo_CTF_Relion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">square_side</span></em>, <em class="sig-param"><span class="n">star_record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.cryo_CTF_Relion" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the contrast transfer function corresponding an n x n image with
the sampling interval DetectorPixelSize.</p>
</dd></dl>

<dl class="py function">
<dt id="aspire.aspire.preprocessor.cryo_parse_Relion_CTF_struct">
<code class="sig-prename descclassname">aspire.aspire.preprocessor.</code><code class="sig-name descname">cryo_parse_Relion_CTF_struct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star_record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.aspire.preprocessor.cryo_parse_Relion_CTF_struct" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-aspire.aspire">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aspire.aspire" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aspire.aspire.common.html" class="btn btn-neutral float-right" title="aspire.aspire.common package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aspire.apple.html" class="btn btn-neutral" title="aspire.apple package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Princeton University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>