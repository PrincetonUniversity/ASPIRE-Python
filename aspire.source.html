

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aspire.source package &mdash; ASPIRE 0.6.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="aspire.storage package" href="aspire.storage.html" />
    <link rel="prev" title="aspire.reconstruction package" href="aspire.reconstruction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ASPIRE
          

          
          </a>

          
            
            
              <div class="version">
                0.6.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aspire.html">aspire package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="aspire.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="aspire.abinitio.html">aspire.abinitio package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.apple.html">aspire.apple package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.basis.html">aspire.basis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.commands.html">aspire.commands package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.config.html">aspire.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.covariance.html">aspire.covariance package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.denoising.html">aspire.denoising package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.image.html">aspire.image package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.noise.html">aspire.noise package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.nufft.html">aspire.nufft package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.numeric.html">aspire.numeric package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.operators.html">aspire.operators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.optimization.html">aspire.optimization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.reconstruction.html">aspire.reconstruction package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">aspire.source package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.storage.html">aspire.storage package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.utils.html">aspire.utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="aspire.volume.html">aspire.volume package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire.exceptions">aspire.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="aspire.html#module-aspire">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ASPIRE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
          <li><a href="aspire.html">aspire package</a> &raquo;</li>
        
      <li>aspire.source package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/aspire.source.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aspire-source-package">
<h1>aspire.source package<a class="headerlink" href="#aspire-source-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-aspire.source.mrcstack">
<span id="aspire-source-mrcstack-module"></span><h2>aspire.source.mrcstack module<a class="headerlink" href="#module-aspire.source.mrcstack" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.source.mrcstack.MrcStack">
<em class="property">class </em><code class="descclassname">aspire.source.mrcstack.</code><code class="descname">MrcStack</code><span class="sig-paren">(</span><em>filepath</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.mrcstack.MrcStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aspire.source.ImageSource" title="aspire.source.ImageSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aspire.source.ImageSource</span></code></a></p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
</dd></dl>

</div>
<div class="section" id="module-aspire.source.relion">
<span id="aspire-source-relion-module"></span><h2>aspire.source.relion module<a class="headerlink" href="#module-aspire.source.relion" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.source.relion.RelionSource">
<em class="property">class </em><code class="descclassname">aspire.source.relion.</code><code class="descname">RelionSource</code><span class="sig-paren">(</span><em>filepath</em>, <em>data_folder=None</em>, <em>pixel_size=1</em>, <em>B=0</em>, <em>n_workers=-1</em>, <em>max_rows=None</em>, <em>memory=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.relion.RelionSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aspire.source.ImageSource" title="aspire.source.ImageSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aspire.source.ImageSource</span></code></a></p>
<p>Load STAR file at given filepath
:param filepath: Absolute or relative path to STAR file
:param data_folder: Path to folder w.r.t which all relative paths to .mrcs files are resolved.</p>
<blockquote>
<div>If None, the folder corresponding to filepath is used.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pixel_size</strong> – the pixel size of the images in angstroms (Default 1)</li>
<li><strong>B</strong> – the envelope decay of the CTF in inverse square angstrom (Default 0)</li>
<li><strong>n_workers</strong> – Number of threads to spawn to read referenced .mrcs files (Default -1 to auto detect)</li>
<li><strong>max_rows</strong> – Maximum number of rows in STAR file to read. If None, all rows are read.
Note that this refers to the max number of images to load, not the max. number of .mrcs files (which may be
equal to or less than the number of images).</li>
<li><strong>memory</strong> – str or None
The path of the base directory to use as a data store or None. If None is given, no caching is performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<dl class="classmethod">
<dt id="aspire.source.relion.RelionSource.starfile2df">
<em class="property">classmethod </em><code class="descname">starfile2df</code><span class="sig-paren">(</span><em>filepath</em>, <em>data_folder=None</em>, <em>max_rows=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.relion.RelionSource.starfile2df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aspire.source.simulation">
<span id="aspire-source-simulation-module"></span><h2>aspire.source.simulation module<a class="headerlink" href="#module-aspire.source.simulation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.source.simulation.Simulation">
<em class="property">class </em><code class="descclassname">aspire.source.simulation.</code><code class="descname">Simulation</code><span class="sig-paren">(</span><em>L=8</em>, <em>n=1024</em>, <em>vols=None</em>, <em>states=None</em>, <em>unique_filters=None</em>, <em>filter_indices=None</em>, <em>offsets=None</em>, <em>amplitudes=None</em>, <em>dtype=&lt;class 'numpy.float32'&gt;</em>, <em>C=2</em>, <em>angles=None</em>, <em>seed=0</em>, <em>memory=None</em>, <em>noise_filter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aspire.source.ImageSource" title="aspire.source.ImageSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aspire.source.ImageSource</span></code></a></p>
<p>A Cryo-EM simulation
Other than the base class attributes, it has:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>C</strong> – The number of distinct volumes</li>
<li><strong>angles</strong> – A 3-by-n array of rotation angles</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="aspire.source.simulation.Simulation.clean_images">
<code class="descname">clean_images</code><span class="sig-paren">(</span><em>start=0</em>, <em>num=inf</em>, <em>indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.clean_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.covar_true">
<code class="descname">covar_true</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.covar_true" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eigs">
<code class="descname">eigs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eigs" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigendecomposition of volume covariance matrix of simulation
:return: A 2-tuple:</p>
<blockquote>
<div>eigs_true: The eigenvectors of the volume covariance matrix in the form of Volume instance.
lambdas_true: The eigenvalues of the covariance matrix in the form of a (C-1)-by-(C-1) diagonal matrix.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_clustering">
<code class="descname">eval_clustering</code><span class="sig-paren">(</span><em>vol_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate clustering estimation
:param vol_idx: Indexes of the volumes determined (0-indexed)
:return: Accuracy [0-1] in terms of proportion of correctly assigned labels</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_coords">
<code class="descname">eval_coords</code><span class="sig-paren">(</span><em>mean_vol</em>, <em>eig_vols</em>, <em>coords_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate coordinate estimation
:param mean_vol: A mean volume in the form of a Volume instance.
:param eig_vols: A set of eigenvolumes in an Volume instance.
:param coords_est: The estimated coordinates in the affine space defined centered at <cite>mean_vol</cite> and spanned</p>
<blockquote>
<div>by <cite>eig_vols</cite>.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_covar">
<code class="descname">eval_covar</code><span class="sig-paren">(</span><em>covar_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_covar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_eigs">
<code class="descname">eval_eigs</code><span class="sig-paren">(</span><em>eigs_est</em>, <em>lambdas_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_eigs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate covariance eigendecomposition accuracy
:param eigs_est: The estimated volume eigenvectors in an L-by-L-by-L-by-K array.
:param lambdas_est: The estimated eigenvalues in a K-by-K diagonal matrix (default <cite>diag(ones(K, 1))</cite>).
:return:</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_gaussian_blobs">
<code class="descname">eval_gaussian_blobs</code><span class="sig-paren">(</span><em>L</em>, <em>Q</em>, <em>D</em>, <em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_gaussian_blobs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_mean">
<code class="descname">eval_mean</code><span class="sig-paren">(</span><em>mean_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_vol">
<code class="descname">eval_vol</code><span class="sig-paren">(</span><em>vol_true</em>, <em>vol_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_vol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.eval_volmat">
<code class="descname">eval_volmat</code><span class="sig-paren">(</span><em>volmat_true</em>, <em>volmat_est</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.eval_volmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate volume matrix estimation accuracy
:param volmat_true: The true volume matrices in the form of an L-by-L-by-L-by-L-by-L-by-L-by-K array.
:param volmat_est: The estimated volume matrices in the same form.
:return:</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.mean_true">
<code class="descname">mean_true</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.mean_true" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.projections">
<code class="descname">projections</code><span class="sig-paren">(</span><em>start=0</em>, <em>num=inf</em>, <em>indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.projections" title="Permalink to this definition">¶</a></dt>
<dd><p>Return projections of generated volumes, without applying filters/shifts/amplitudes/noise
:param start: start index (0-indexed) of the start image to return
:param num: Number of images to return. If None, <em>all</em> images are returned.
:param indices: A numpy array of image indices. If specified, start and num are ignored.
:return: An Image instance.</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.simulation.Simulation.vol_coords">
<code class="descname">vol_coords</code><span class="sig-paren">(</span><em>mean_vol=None</em>, <em>eig_vols=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.simulation.Simulation.vol_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates of simulation volumes in a given basis
:param mean_vol: A mean volume in the form of a Volume Instance (default <cite>mean_true</cite>).
:param eig_vols: A set of k volumes in a Volume instance (default <cite>eigs</cite>).
:return:</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aspire.source">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-aspire.source" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="aspire.source.ArrayImageSource">
<em class="property">class </em><code class="descclassname">aspire.source.</code><code class="descname">ArrayImageSource</code><span class="sig-paren">(</span><em>im</em>, <em>metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ArrayImageSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#aspire.source.ImageSource" title="aspire.source.ImageSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aspire.source.ImageSource</span></code></a></p>
<p>An <cite>ImageSource</cite> object that holds a reference to an underlying <cite>Image</cite> object (a thin wrapper on an ndarray)
representing images. It does not produce its images on the fly, but keeps them in memory. As such, it should not be
used where large Image objects are involved, but can be used in situations where API conformity is desired.</p>
<p>Note that this class does not provide an <cite>_images</cite> method, since it populates the <cite>_cached_im</cite> attribute which,
if available, is consulted directly by the parent class, bypassing <cite>_images</cite>.</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<p>Initialize from an <cite>Image</cite> object
:param im: An <cite>Image</cite> object representing image data served up by this <cite>ImageSource</cite>
:param metadata: A Dataframe of metadata information corresponding to this ImageSource’s images</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
</dd></dl>

<dl class="class">
<dt id="aspire.source.ImageSource">
<em class="property">class </em><code class="descclassname">aspire.source.</code><code class="descname">ImageSource</code><span class="sig-paren">(</span><em>L</em>, <em>n</em>, <em>dtype='double'</em>, <em>metadata=None</em>, <em>memory=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>When creating an <cite>ImageSource</cite> object, a ‘metadata’ table holds metadata information about all images in the
<cite>ImageSource</cite>. The number of rows in this metadata table will equal the total number of images supported by this
<cite>ImageSource</cite> (available as the ‘n’ attribute), though reading/writing of images is usually done in chunks.</p>
<p>This metadata table is implemented as a pandas <cite>DataFrame</cite>.</p>
<p>The ‘values’ in this metadata table are usually primitive types (floats/ints/strings) that are suitable
for being read from STAR files, and being written to STAR files. The columns corresponding to these fields
begin with a single underscore ‘_’.</p>
<p>In addition, the metadata table may also contain references to Python objects.
<cite>Filter</cite> objects, for example, are stored in this metadata table as references to unique <cite>Filter</cite> objects that
correspond to images in this <cite>ImageSource</cite>. Several rows of metadata may end up containing a reference to a small
handful of unique <cite>Filter</cite> objects, depending on the values found in other columns (identical <cite>Filter</cite>
objects, depending on unique CTF values found for _rlnDefocusU/_rlnDefocusV etc.</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<p>A Cryo-EM ImageSource object that supplies images along with other parameters for image manipulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>L</strong> – resolution of (square) images (int)</li>
<li><strong>n</strong> – The total number of images available
Note that images() may return a different number of images based on its arguments.</li>
<li><strong>metadata</strong> – A Dataframe of metadata information corresponding to this ImageSource’s images</li>
<li><strong>memory</strong> – str or None
The path of the base directory to use as a data store or None. If None is given, no caching is performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<dl class="attribute">
<dt id="aspire.source.ImageSource.amplitudes">
<code class="descname">amplitudes</code><a class="headerlink" href="#aspire.source.ImageSource.amplitudes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.angles">
<code class="descname">angles</code><a class="headerlink" href="#aspire.source.ImageSource.angles" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Rotation angles in radians, as a n x 3 array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.cache">
<code class="descname">cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.downsample">
<code class="descname">downsample</code><span class="sig-paren">(</span><em>L</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.downsample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.eval_filter_grid">
<code class="descname">eval_filter_grid</code><span class="sig-paren">(</span><em>L</em>, <em>power=1</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.eval_filter_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.eval_filters">
<code class="descname">eval_filters</code><span class="sig-paren">(</span><em>im_orig</em>, <em>start=0</em>, <em>num=inf</em>, <em>indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.eval_filters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.filter_indices">
<code class="descname">filter_indices</code><a class="headerlink" href="#aspire.source.ImageSource.filter_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.get_metadata">
<code class="descname">get_metadata</code><span class="sig-paren">(</span><em>metadata_fields</em>, <em>indices=None</em>, <em>default_value=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Get metadata field information of this ImageSource for selected indices
:param metadata_fields: A string, of list of strings, representing the metadata field(s) to be queried.
:param indices: A list of 0-based indices indicating the indices for which to get metadata.</p>
<blockquote>
<div>If indices is None, then values corresponding to all indices in this Source object are returned.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>default_value</strong> – Default scalar value to use for any fields not found in the metadata. If None,
no default value is used, and missing field(s) cause a RuntimeError.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An ndarray of values (any valid np types) representing metadata info.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.has_metadata">
<code class="descname">has_metadata</code><span class="sig-paren">(</span><em>metadata_fields</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.has_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out if one more more metadata fields are available for this <cite>ImageSource</cite>.
:param metadata_fields: A string, of list of strings, representing the metadata field(s) to be queried.
:return: Boolean value indicating whether the field(s) are available.</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.im_backward">
<code class="descname">im_backward</code><span class="sig-paren">(</span><em>im</em>, <em>start</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.im_backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply adjoint mapping to set of images
:param im: An Image instance to which we wish to apply the adjoint of the forward model.
:param start: Start index of image to consider
:return: An L-by-L-by-L volume containing the sum of the adjoint mappings applied to the start+num-1 images.</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.images">
<code class="descname">images</code><span class="sig-paren">(</span><em>start</em>, <em>num</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.images" title="Permalink to this definition">¶</a></dt>
<dd><p>Return images from this ImageSource as an Image object.
:param start: The inclusive start index from which to return images.
:param num: The exclusive end index up to which to return images.
:param args: Any additional positional arguments to pass on to the <cite>ImageSource</cite>’s underlying <cite>_images</cite> method.
:param kwargs: Any additional keyword arguments to pass on to the <cite>ImageSource</cite>’s underlying <cite>_images</cite> method.
:return: an <cite>Image</cite> object.</p>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.invert_contrast">
<code class="descname">invert_contrast</code><span class="sig-paren">(</span><em>batch_size=512</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.invert_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>invert the global contrast of images</p>
<p>Check if all images in a stack should be globally phase flipped so that
the molecule corresponds to brighter pixels and the background corresponds
to darker pixels. This is done by comparing the mean in a small circle
around the origin (supposed to correspond to the molecule) with the mean
of the noise, and making sure that the mean of the molecule is larger.
From the implementation level, we modify the <cite>ImageSource</cite> in-place by
appending a <cite>Multiple</cite> filter to the generation pipeline.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> – Batch size of images to query.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">On return, the <cite>ImageSource</cite> object has been modified in place.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.metadata_fields">
<code class="descname">metadata_fields</code><em class="property"> = {'_rlnAmplitudeContrast': &lt;class 'float'&gt;, '_rlnAnglePsi': &lt;class 'float'&gt;, '_rlnAngleRot': &lt;class 'float'&gt;, '_rlnAngleTilt': &lt;class 'float'&gt;, '_rlnClassNumber': &lt;class 'int'&gt;, '_rlnCoordinateX': &lt;class 'float'&gt;, '_rlnCoordinateY': &lt;class 'float'&gt;, '_rlnCoordinateZ': &lt;class 'float'&gt;, '_rlnCtfFigureOfMerit': &lt;class 'float'&gt;, '_rlnCtfImage': &lt;class 'str'&gt;, '_rlnDefocusAngle': &lt;class 'float'&gt;, '_rlnDefocusU': &lt;class 'float'&gt;, '_rlnDefocusV': &lt;class 'float'&gt;, '_rlnDetectorPixelSize': &lt;class 'float'&gt;, '_rlnGroupName': &lt;class 'str'&gt;, '_rlnGroupNumber': &lt;class 'str'&gt;, '_rlnImageName': &lt;class 'str'&gt;, '_rlnLogLikeliContribution': &lt;class 'float'&gt;, '_rlnMagnification': &lt;class 'float'&gt;, '_rlnMaxValueProbDistribution': &lt;class 'float'&gt;, '_rlnMicrographName': &lt;class 'str'&gt;, '_rlnNormCorrection': &lt;class 'float'&gt;, '_rlnNrOfFrames': &lt;class 'int'&gt;, '_rlnNrOfSignificantSamples': &lt;class 'float'&gt;, '_rlnOriginX': &lt;class 'float'&gt;, '_rlnOriginY': &lt;class 'float'&gt;, '_rlnOriginalName': &lt;class 'str'&gt;, '_rlnOriginalParticleName': &lt;class 'str'&gt;, '_rlnParticleName': &lt;class 'str'&gt;, '_rlnRandomSubset': &lt;class 'int'&gt;, '_rlnSphericalAberration': &lt;class 'float'&gt;, '_rlnVoltage': &lt;class 'float'&gt;}</em><a class="headerlink" href="#aspire.source.ImageSource.metadata_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.normalize_background">
<code class="descname">normalize_background</code><span class="sig-paren">(</span><em>bg_radius=1.0</em>, <em>do_ramp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.normalize_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the images by the noise background</p>
<p>This is done by shifting the image density by the mean value of background
and scaling the image density by the standard deviation of background.
From the implementation level, we modify the <cite>ImageSource</cite> in-place by
appending the <cite>Add</cite> and <cite>Multiple</cite> filters to the generation pipeline.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bg_radius</strong> – Radius cutoff to be considered as background (in image size)</li>
<li><strong>do_ramp</strong> – When it is <cite>True</cite>, fit a ramping background to the data
and subtract. Namely perform normalization based on values from each image.
Otherwise, a constant background level from all images is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">On return, the <cite>ImageSource</cite> object has been modified in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.offsets">
<code class="descname">offsets</code><a class="headerlink" href="#aspire.source.ImageSource.offsets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.phase_flip">
<code class="descname">phase_flip</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.phase_flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform phase flip to images in the source object using CTF information</p>
</dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.rots">
<code class="descname">rots</code><a class="headerlink" href="#aspire.source.ImageSource.rots" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Rotation matrices as a n x 3 x 3 array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>starfile_filepath</em>, <em>batch_size=512</em>, <em>save_mode=None</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the output images to mrc files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>batch_size</strong> – Batch size of images to query.</li>
<li><strong>save_mode</strong> – Whether to save all images in a single or multiple files in batch size.</li>
<li><strong>overwrite</strong> – Option to overwrite the output mrcs files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.set_metadata">
<code class="descname">set_metadata</code><span class="sig-paren">(</span><em>metadata_fields</em>, <em>values</em>, <em>indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.set_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify metadata field information of this ImageSource for selected indices
:param metadata_fields: A string, or list of strings, representing the metadata field(s) to be modified
:param values: A scalar or vector (of length <a href="#id1"><span class="problematic" id="id2">|indices|</span></a>) of replacement values.
:param indices: A list of 0-based indices indicating the indices for which to modify metadata.</p>
<blockquote>
<div>If indices is None, then all indices in this Source object are modified. In this case,
values should either be a scalar or a vector of length equal to the total number of images, <a href="#id3"><span class="problematic" id="id4">|self.n|</span></a>.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">On return, the metadata associated with the specified indices has been modified.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="aspire.source.ImageSource.states">
<code class="descname">states</code><a class="headerlink" href="#aspire.source.ImageSource.states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.vol_forward">
<code class="descname">vol_forward</code><span class="sig-paren">(</span><em>vol</em>, <em>start</em>, <em>num</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.vol_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply forward image model to volume
:param vol: A volume instance.
:param start: Start index of image to consider
:param num: Number of images to consider
:return: The images obtained from volume by projecting, applying CTFs, translating, and multiplying by the</p>
<blockquote>
<div>amplitude.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="aspire.source.ImageSource.whiten">
<code class="descname">whiten</code><span class="sig-paren">(</span><em>noise_filter</em><span class="sig-paren">)</span><a class="headerlink" href="#aspire.source.ImageSource.whiten" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the <cite>ImageSource</cite> in-place by appending a whitening filter to the generation pipeline.
:param noise_filter: The noise psd of the images as a <cite>Filter</cite> object. Typically determined by a</p>
<blockquote>
<div>NoiseEstimator class, and available as its <cite>filter</cite> attribute.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">On return, the <cite>ImageSource</cite> object has been modified in place.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aspire.storage.html" class="btn btn-neutral float-right" title="aspire.storage package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aspire.reconstruction.html" class="btn btn-neutral float-left" title="aspire.reconstruction package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Princeton University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>